===============================================================================
脚本信息
===============================================================================

羊牌 UUP 下载向导（程序名：uupdownload - legacy.cmd 和 uupdownload - app.cmd），是基于 uupdump 下载脚本设计开发的 uup 文件下载专用工具。
通过填写 UUP ID 进行 UUP 文件的下载。此向导同时提供“仅下载”和“下载并转换”2 个版本。“下载并转换”版本支持下载后自动转制 ISO。

===============================================================================
更新 ID 的获取（非工具）
===============================================================================

由于 UUP Dump 的更改，现在单独列出更新 ID。但是，这并不意味着你无法再获取更新 ID。在选择了你要下载的版本后，你在浏览器地址栏看到的是如下地址：

https://uupdump.net/selectlang.php?id=7c7aac60-93b5-4733-b7ee-d6fd13c9bce6

其中，id 后面的即为更新 ID。复制并粘贴到向导指定页面中即可继续像以前一样下载 UUP 文件。

如果你还希望采用以前的方式获取更新 ID，第一种方法是在 UUP Dump 首页的快速选项获取更新 ID：

https://uupdump.net/fetchupd.php?arch=arch&ring=ring&build=build&lang=lang
或
https://uupdump.net/fetchupd.php?arch=arch&sku=sku&ring=ring&build=build&lang=lang

你可以通过替换 build、ring 和 sku 进行版本的筛选。允许值如下：
sku：具体 SKU 版本代号，如专业版为 125。
arch：amd64、arm64、x86
ring：retail、rp、wis、wif，具体使用的通道受制于当前推送版本本身。
build：一般使用的内部版本，如 22621.1、25188.1000，或者 latest。具体使用的版本受制于当前推送版本本身。
lang：可选，位于整个地址的最后。将直接决定网站页面文本使用何种语言显示，如果是简体中文显示网站界面，则使用 zh-cn
具体使用的版本和通道受制于当前推送版本本身。

最后一种方法是可以前往以下站点获取：https://uupdump.7788.work/?lang=zh-cn

此部分获取方式随时发生变化，因此相应更改将会随着向导的更新而推出。

===============================================================================
更新 ID 的获取（工具）
===============================================================================

由于 UUP Dump 的更改，现在单独列出更新 ID。但是，这并不意味着你无法再获取更新 ID。在选择了你要下载的版本后，你在浏览器地址栏看到的是如下地址：

https://uupdump.net/selectlang.php?id=7c7aac60-93b5-4733-b7ee-d6fd13c9bce6

你可以通过向导内置工具 get_update_id.cmd 进行更新 ID 的获取。通过提示进行操作。

此部分获取方式随时发生变化，因此相应更改将会随着向导的更新而推出。

===============================================================================
使用方式（传统版本，uupdownload - legacy.cmd）
===============================================================================

此脚本工具使用菜单选择，不区分是否使用大小键盘。除填写更新 ID 步骤和语言选择步骤之外，均为选择后自动进入下一步。

准备步骤：
运行向导后，要求你选择显示语言。通过在菜单中选择参数来控制语言的显示。
支持在 1 和 2 之间设置向导的显示语言。参数规定如下：
1 - 英语
2 - 简体中文
选择之后将会立即转到网络预先设置页面。对于带转制功能的版本，此项还将会同步影响转制工具的语言。

在选择对应的界面语言后进行如下的步骤：
第一步：在网络预先设置选择网络检测设置。此部分提供 2 个选项：“默认设置”和“备用设置”。
选择之后将会立即转到选择操作系统平台类型页面。
A - 默认设置
使用的是默认的参数，不禁用吊销许可证检测。
B - 备用设置
使用禁用吊销许可证检测参数，在遇到吊销服务器检测失败时可用。也可以作为保护手段使用。
C - 打开 UUPdump 网站
将会直接在浏览器打开 UUPdump 网站。

第二步：选择操作系统的平台类型
此步骤将控制所选 UUP 下载版本的平台类型。此部分提供 2 个选项：“客户端”和“服务器端”。
选择之后将会立即转到语言选择页面。
A - 客户端
将可下载家庭版、专业版等一般常见基础版本（不包括虚拟升级版本，如企业版等）
B - 服务器端
将可下载 Standard、Datacenter 等服务器用途的版本。具体操作见“下载 Server 的 UUP 文件”部分

第四步：选择 UUP 文件的语言版本
在菜单中提供了 UUP 支持下载的所有语言。你可以根据自己的需要，选择自己的语言。使用两位数确定语言版本，第一位没有的，请使用 0 占位。例如语言编号为 3，应输入 03 再按“Enter”键
选择之后将会立即转到选择 SKU 版本页面。

第五步：选择 SKU 版本
选择自己需要的 SKU 版本。在当前版本工具中，单一版本下载选项现在使用分组。所有选项如下所示
以下版本可在任何国家和地区使用：
   1 - 家庭版
   2 - 专业版
   3 - 协同版
以下版本仅在中国地区使用：
   4 - 家庭中文版
以下版本可在欧洲地区使用：
   5 - 家庭版 N
   6 - 专业版 N
如果你希望下载多个版本，可使用此选项：
   7 - 下载组合版本
下载应用文件：
   8 - Microsoft Store 内置应用（Build 22563 及以上版本）
根据你的语言和地区共同参考，选择其中的任何一个，之后按“Enter”键即可转到填写更新 ID 页面。

第六步：填写更新 ID
此步骤要求你填写要下载版本的 UUP 更新 ID。将复制到的更新 ID 粘贴进窗口中即可完成填写。
填写的 ID 如同：
                 cbdaf931-72ae-4da8-ac28-ce0346ec88ca
无需填写具体版本名称和体系结构，每一版本对应每一体系结构的更新 ID 均为唯一 ID。
填写完成后，按“Enter”键即可开始下载 UUP 文件，所有的 UUP 文件都会下载到 \UUPdownload\UUPs。
下载完成后，按任意键即可关闭脚本。如果其中有一个或几个文件下载失败，再次运行此工具，执行相同操作即可完成缺失文件的补充。
再次运行将仅补充下载前一次下载出错或未完成下载的文件，已下载的文件不受影响。

第七步：转制 ISO（仅限下载并转制版本）
在进行了前面的步骤以后，将会自动解压内置的 uup-converter-wimlib 工具并开始转制。如果前面的 UUP 下载不完整，你将不会进行到此步骤。
在 UUP 文件补充完整后，此步骤将会开始。

===============================================================================
使用方式（下载应用版本，uupdownload - app.cmd）
===============================================================================

此脚本工具具有操作系统版本限制，操作系统的最低可以使用版本是 Build 22563。
使用菜单选择，不区分是否使用大小键盘。除填写更新 ID 步骤和语言选择步骤之外，均为选择后自动进入下一步。

准备步骤：
运行向导后，要求你选择显示语言。通过在菜单中选择参数来控制语言的显示。
支持在 1 和 2 之间设置向导的显示语言。参数规定如下：
1 - 英语
2 - 简体中文
选择之后将会立即转到网络预先设置页面。对于带转制功能的版本，此项还将会同步影响转制工具的语言。

在选择对应的界面语言后进行如下的步骤：
第一步：在网络预先设置选择网络检测设置。此部分提供 2 个选项：“默认设置”和“备用设置”。
选择之后将会立即转到选择操作系统平台类型页面。
A - 默认设置
使用的是默认的参数，不禁用吊销许可证检测。
B - 备用设置
使用禁用吊销许可证检测参数，在遇到吊销服务器检测失败时可用。也可以作为保护手段使用。
C - 打开 UUPdump 网站
将会直接在浏览器打开 UUPdump 网站。

第二步：选择操作系统的平台类型
此步骤将控制所选 UUP 下载版本的平台类型。此部分提供 1 个选项：“客户端”。不支持下载 Server 的 UUP 文件，下载 Server 的 UUP 文件，你应使用传统版本（uupdownload.cmd）。
选择之后将会立即转到语言选择页面。
A - 客户端
将可下载家庭版、专业版等一般常见基础版本（不包括虚拟升级版本，如企业版等）

第四步：选择 UUP 文件的语言版本
在菜单中提供了 UUP 支持下载的所有语言。你可以根据自己的需要，选择自己的语言。使用两位数确定语言版本，第一位没有的，请使用 0 占位。例如语言编号为 3，应输入 03 再按“Enter”键
选择之后将会立即转到选择 SKU 版本页面。

第五步：选择 SKU 版本
选择自己需要的 SKU 版本。在当前版本工具中，单一版本下载选项现在使用分组。所有选项如下所示
以下版本可在任何国家和地区使用：
   1 - 家庭版
   2 - 专业版
   3 - 协同版
以下版本仅在中国地区使用：
   4 - 家庭中文版
以下版本可在欧洲地区使用：
   5 - 家庭版 N
   6 - 专业版 N
如果你希望下载多个版本，可使用此选项：
   7 - 下载组合版本
根据你的语言和地区共同参考，选择其中的任何一个，之后按“Enter”键即可转到填写更新 ID 页面。

第六步：填写更新 ID
此步骤要求你填写要下载版本的 UUP 更新 ID。将复制到的更新 ID 粘贴进窗口中即可完成填写。
填写的 ID 如同：
                 cbdaf931-72ae-4da8-ac28-ce0346ec88ca
无需填写具体版本名称和体系结构，每一版本对应每一体系结构的更新 ID 均为唯一 ID。
填写完成后，按“Enter”键即可开始下载 UUP 文件，所有的 UUP 文件都会下载到 \UUPdownload\UUPs。
下载完成后，按任意键即可关闭脚本。如果其中有一个或几个文件下载失败，再次运行此工具，执行相同操作即可完成缺失文件的补充。
再次运行将仅补充下载前一次下载出错或未完成下载的文件，已下载的文件不受影响。

第七步：转制 ISO（仅限下载并转制版本）
在进行了前面的步骤以后，将会自动解压内置的 uup-converter-wimlib 工具并开始转制。如果前面的 UUP 下载不完整，你将不会进行到此步骤。
在 UUP 文件补充完整后，此步骤将会开始。

===============================================================================
下载协同版（Team）（仅限传统版本 uupdownload - legacy.cmd）
===============================================================================

此工具仅支持版本 2004 及以上版本的协同版下载，此工具提供的版本数量和信息由 UUPdump 数据库决定。具体执行如下：
在使用方式的第三步中，按 3 并按“Enter”键后，你将会有三个版本选择：
1 - 19042.538 (20H2_release 和相关分支)
2 - 19042.545 (20H2_release 和相关分支)
3 - 19042.572 (20H2_release 和相关分支)
同时还提供了尚在预览的 Build 19100 和 Build 19101 的下载：
Build 19100.1008~Build 19101.1109
选择其中的一个之后，将直接开始下载。
对于 Build 19100（不含）以上的协同版，以及所有位于 Dev 渠道的协同版，你可在协同版菜单中选择“其他 Dev 渠道版本”进行下载。

注意事项：
某些协同版不支持全部语言，仅支持少数语言。

===============================================================================
下载 Server 的 UUP 文件（仅限传统版本 uupdownload - legacy.cmd）
===============================================================================

在 Windows Server 2022 发布的同时，新增了通过 UUP 下载方式，可通过此方式执行同客户端版本下载相似的过程获得 Server 操作系统的完整操作系统文件。

在使用方式的第二步中，按 B 并按“Enter”键后，你将会有六个选择：
1 - Azure Stack HCI
2 - Windows Server Standard，Core
3 - Windows Server Datacenter，Core
4 - Windows Server Standard
5 - Windows Server Datacenter
6 - 下载组合版本
根据自身需要选择其中的任何一个，之后进入到前述第六步填写更新 ID，按“Enter”键即可开始下载对应组合版本的 UUP 文件。
下载完成之后即可开始转换（仅限下载并转制版本）。

===============================================================================
下载组合版本的 UUP 文件（客户端）
===============================================================================

在使用方式的第五步中，按 8 并按“Enter”键后，你将会有四个组合可选：
1 - 家庭版和家庭中文版
2 - 家庭版和专业版
3 - 家庭中文版和专业版
4 - 家庭版、家庭中文版和专业版
选择其中的任何一个组合，之后进入到前述第六步填写更新 ID，按“Enter”键即可开始下载对应组合版本的 UUP 文件。
下载完成之后即可开始转换（仅限下载并转制版本）。

===============================================================================
下载组合版本的 UUP 文件（服务器端）（仅限传统版本 uupdownload.cmd）
===============================================================================

在使用方式的第五步中，按 8 并按“Enter”键后，你将会有五个组合可选：
以下组合版本无桌面体验：
1 - Windows Server Standard Core 和 Datacenter Core
以下组合版本为完整版本：
2 - Windows Server Standard 和 Datacenter
以下组合版本为混合版本：
3 - Windows Server Standard Core 和 Standard
4 - Windows Server Datacenter Core 和 Datacenter
以下组合版本为全部合集，不包括 Azure Stack HCI：
5 - Windows Server Standard Core、Standard、Datacenter Core 和 Datacenter
选择其中的任何一个组合，之后进入到前述第六步填写更新 ID，按“Enter”键即可开始下载对应组合版本的 UUP 文件。
下载完成之后即可开始转换（仅限下载并转制版本）。

===============================================================================
下载内置应用（仅限传统版本 uupdownload.cmd）
===============================================================================

自 Windows 11 Insider Preview Build 22563 开始，Microsoft 官方不再通过独立 esd 文件提供应用的下载，而是改为直接提供散装应用包下载。

因此，在下载了 UUP 后，你还需要下载内置应用。所下载的内置应用存储位置与你下载的 UUP 文件相同。

为了确保操作系统在转换后是完整的，对于 Build 22563 及以上版本，你直接使用 app 版本（uupdownload - app.cmd）进行下载。

在第二次运行向导时：
在使用方式的第四步中，输入 39 并按“Enter”键后，在第五步中按 8 并按“Enter”键，将会进入到前述第六步填写更新 ID，按“Enter”键即可开始下载对应版本的内置应用。

下载完成之后即可用于转换。

（仅限下载并转换 ISO 版本）在第一次运行向导下载 UUP 完成后，关闭向导，并第二次运行，操作过程同上。不同的是，你将在第二次运行时正常运行后续转换步骤。

===============================================================================
注意事项
===============================================================================

对于所需的更新 ID，请按照本说明开始的“更新 ID 的获取”部分进行获取。

提供部分更新 ID 示例，这些均为可用 ID：
针对 Azure Stack HCI 的功能更新，版本 22H2（20349.946）x64 025319ad-e6d9-495f-bdb8-cd8099b99428

针对 Microsoft Server 操作系统的功能更新，版本 21H2（20348.887）x64 977fe79e-3f7a-4f29-bbc9-3b43782b3ba6

Windows 11（22621.457）x64 7c7aac60-93b5-4733-b7ee-d6fd13c9bce6

Windows 11 (22000.856) x64 d82f8ecf-202d-47ac-89a2-2562a7528027

===============================================================================
贡献者（感谢）
===============================================================================

https://uupdump.net/ - 下载工具原始版本（任意版本均可生成），该网站项目库（原归属于 whatever127，现由 awuctl 和 Luzea 负责）：https://github.com/uup-dump

abbodi1406 - UUP converter wimlib 作者，感谢其不断更新和完善相关工具。

正义羊（JRJSheep） - 菜单和界面设计，版本参数控制及后续测试
